{% extends "base.html" %}
{% block content %}
<h2>Scan History</h2>

<form method="GET" action="{{ url_for('history') }}" class="row" style="margin-bottom:16px;">
  <input type="text" name="query" placeholder="Search domain" value="{{ query or '' }}">
  <button type="submit">Search</button>
  <a class="link" href="{{ url_for('history') }}">Clear</a>
</form>

{% if history %}
  <div class="section">
    <ul>
      {% for entry in history %}
        <li style="margin-bottom:12px;">
          <strong>{{ entry.domain }}</strong>
          {% if entry.pulses and entry.pulses|length > 0 %}
            <div>OTX Pulses:</div>
            <ul>
              {% for pulse in entry.pulses %}
                <li>{{ pulse.name }} â€” {{ pulse.description }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <div class="no-data">No pulses found for this domain.</div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
{% else %}
  <p class="no-data">No history found yet.</p>
{% endif %}
{% endblock %}
